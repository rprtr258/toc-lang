{"id":"toc-lang-0y1","title":"Create comprehensive styling tests and examples","description":"Create test cases and example files demonstrating all styling features: custom shapes, colors, edge styling, and property precedence. Update newSyntax.test.ts and create example files showing styled diagrams.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T22:21:12.687721298+03:00","updated_at":"2025-12-26T22:34:28.7497273+03:00","closed_at":"2025-12-26T22:34:28.7497273+03:00","close_reason":"Closed via update","dependencies":[{"issue_id":"toc-lang-0y1","depends_on_id":"toc-lang-6ca","type":"blocks","created_at":"2025-12-26T22:21:21.581898817+03:00","created_by":"daemon"}]}
{"id":"toc-lang-13i","title":"Design PIC-like syntax proposal","description":"Design PIC-like syntax proposal\n\nBased on research in docs/PIC_SYNTAX.md and proposed syntax in docs/PROPOSED_SYNTAX.md, design PIC-like syntax proposal that maintains TOC semantics.\n\nCurrent TOC-Lang:\n  type: problem\n  bad: \"Bad experience\" {class: UDE}\n  cluttered: \"Cluttered UI\" {class: UDE}\n  bad \u003c- cluttered\n  cluttered \u003c- ux \u0026\u0026 features\n\nProposed PIC-like syntax:\n  .problem\n  box UDE \"Bad experience\"\n  box UDE \"Cluttered UI\"\n  arrow left 200% from last box\n  ux: box \"Low UX investment\"\n  features: box \"Many features\"\n  arrow left from ux \u0026\u0026 features\n\nKey changes:\n1. Shape-based nodes: box UDE \"label\" instead of id: \"label\" {class: UDE}\n2. Directive-style type: .problem instead of type: problem\n3. Positioning: arrow left from last box or from ux \u0026\u0026 features\n4. Inline edge labels: arrow left \"because\" from A to B\n5. Variables: ux: box \"...\" for named references\n6. Keep multi-cause support: from A \u0026\u0026 B to C\n\nFocus on making it concise while preserving TOC semantics (UDE, CSF, FOL, etc.).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T20:22:35.063258754+03:00","updated_at":"2025-12-26T21:24:17.485725341+03:00","closed_at":"2025-12-26T21:24:17.485725341+03:00","close_reason":"Closed via update","dependencies":[{"issue_id":"toc-lang-13i","depends_on_id":"toc-lang-p1c","type":"blocks","created_at":"2025-12-26T20:22:35.073615215+03:00","created_by":"daemon"}]}
{"id":"toc-lang-1m3","title":"Add property key completion to CodeMirror","description":"Add autocomplete for property keys in CodeMirror language support\n\nAfter typing a space in node/edge context, suggest:\n- For nodes: class, status, shape, border, fill\n- For edges: color\n\nThis should work after the label string or after other properties.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T21:37:45.553440073+03:00","updated_at":"2025-12-26T21:57:07.50933767+03:00","closed_at":"2025-12-26T21:57:07.50933767+03:00","close_reason":"Closed via update","dependencies":[{"issue_id":"toc-lang-1m3","depends_on_id":"toc-lang-jq8","type":"blocks","created_at":"2025-12-26T21:38:43.002650931+03:00","created_by":"daemon"}]}
{"id":"toc-lang-6ca","title":"Implement styling support in Cloud.vue","description":"Add support for shape, fill, border, and color properties in evaporating cloud diagrams. CloudNode.vue and CloudEdge.vue currently ignore styling properties. Need to pass properties through Cloud.vue and render styled nodes/edges.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T22:21:05.844340648+03:00","updated_at":"2025-12-26T22:33:37.766227045+03:00","closed_at":"2025-12-26T22:33:37.766227045+03:00","close_reason":"Closed via update","dependencies":[{"issue_id":"toc-lang-6ca","depends_on_id":"toc-lang-7k6","type":"blocks","created_at":"2025-12-26T22:21:18.733407096+03:00","created_by":"daemon"}]}
{"id":"toc-lang-6rz","title":"Update parser for new syntax","description":"Update parser for new syntax\n\nModify src/parser.ts to parse generic tokens into meaningful AST from docs/PROPOSED_SYNTAX.md.\n\n**Parsing strategy:**\n1. Parse statement as: `IDENT COLON value (IDENT EQUALS IDENT)*`\n2. Check if IDENT starts with `.` → directive\n3. Otherwise → node or edge\n4. Edge detection: look for arrows in the statement\n\n**Statement parsing flow:**\n```\nparseStatement():\n  - Read ID (IDENT)\n  - If ID starts with '.': parseDirective()\n  - Else if next token is COLON: parseNode()\n  - Else: parseEdge()  // ID is first fromId\n```\n\n**Node parsing:**\n```\nparseNode():\n  - id = ID.value (without leading dot if present)\n  - consume COLON\n  - label = STRING\n  - params = parseProperties()\n  - return {type: \"node\", id, text: label, params}\n```\n\n**Edge parsing:**\n```\nparseEdge():\n  - fromIds = parseIdentList()\n  - consume arrow\n  - toId = ID\n  - text = optional STRING after colon\n  - props = parseProperties()\n  - return {type: \"edge\", fromIds, toId, text, ...props}\n```\n\n**Property parsing:**\n```\nparseProperties():\n  - properties = {}\n  - while next token is IDENT:\n    - key = IDENT\n    - consume EQUALS\n    - value = IDENT or STRING\n    - properties[key] = value\n  - return properties\n```\n\n**Directive parsing:**\n```\nparseDirective():\n  - id = ID.value (without leading dot)\n  - consume COLON\n  - value = ID\n  - return {type: \"directive\", id, value}\n```\n\n**Validation:**\n- Node props: class, status, shape, border, fill\n- Edge props: color\n- Shapes: box, circle, ellipse\n- Colors: black, white, blue, yellow, green, red\n- Apply defaults: shape=box, border=black, fill=white\n- Deduplicate: last value wins\n\n**AST updates:**\n```typescript\n// Node AST\n{\n  type: \"node\",\n  id: string,\n  text: string,\n  params: {\n    class?: string,\n    status?: string,\n    shape?: \"box\" | \"circle\" | \"ellipse\",\n    border?: string,\n    fill?: string,\n    [key: string]: string\n  }\n}\n\n// Edge AST\n{\n  type: \"edge\",\n  fromIds: string[],\n  toId: string,\n  text?: string,\n  color?: string,\n  biDirectional?: true\n}\n\n// Directive AST\n{\n  type: \"directive\",\n  id: \"type\",\n  value: string\n}\n```\n\n**Backward compatibility:**\n- Still parse old `{key: value}` format\n- Still parse old `type: problem` format\n- Support both during transition period","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T20:22:46.727068144+03:00","updated_at":"2025-12-26T21:54:42.929336884+03:00","closed_at":"2025-12-26T21:54:42.929336884+03:00","close_reason":"Closed via update","dependencies":[{"issue_id":"toc-lang-6rz","depends_on_id":"toc-lang-bj0","type":"blocks","created_at":"2025-12-26T20:22:46.734987724+03:00","created_by":"daemon"}]}
{"id":"toc-lang-7k6","title":"Implement color properties in Tree.vue","description":"Add support for fill, border, and edge color properties in tree diagrams. Tree.vue currently ignores params.fill, params.border, and edge.params.color. Need to read these properties and apply them to SVG rendering, with proper precedence over status-based coloring.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T22:21:03.830635289+03:00","updated_at":"2025-12-26T22:33:32.968639964+03:00","closed_at":"2025-12-26T22:33:32.968639964+03:00","close_reason":"Closed via update","dependencies":[{"issue_id":"toc-lang-7k6","depends_on_id":"toc-lang-8l3","type":"blocks","created_at":"2025-12-26T22:21:16.075592678+03:00","created_by":"daemon"}]}
{"id":"toc-lang-8l3","title":"Implement shape property support in Tree.vue","description":"Add support for shape property (box, circle, diamond) in tree diagram rendering. Tree.vue currently ignores params.shape and always renders nodes as rectangles. Need to read shape property from node params and render appropriate SVG shape.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T22:21:00.682540234+03:00","updated_at":"2025-12-26T22:33:27.945350997+03:00","closed_at":"2025-12-26T22:33:27.945350997+03:00","close_reason":"Closed via update"}
{"id":"toc-lang-8ra","title":"Add property value completion to CodeMirror","description":"Add autocomplete for property values in CodeMirror language support\n\nAfter `=`, suggest values based on property:\n- shape= → box, circle, ellipse\n- border=, fill=, color= → black, white, blue, yellow, green, red\n- class= → UDE, CSF, FOL, DE\n- status= → numeric values (0-100)\n- type= → problem, conflict, goal (for directives)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T21:37:55.894456395+03:00","updated_at":"2025-12-26T21:57:19.799456034+03:00","closed_at":"2025-12-26T21:57:19.799456034+03:00","close_reason":"Closed via update","dependencies":[{"issue_id":"toc-lang-8ra","depends_on_id":"toc-lang-jq8","type":"blocks","created_at":"2025-12-26T21:38:43.346301805+03:00","created_by":"daemon"}]}
{"id":"toc-lang-bj0","title":"Update tokenizer for new syntax","description":"Update tokenizer for new syntax\n\nModify src/tokenizer.ts to support generic tokenization for PIC-like syntax from docs/PROPOSED_SYNTAX.md.\n\n**Token types to add:**\n- `EQUALS` (=) - for key=value pairs\n\n**Token types to keep:**\n- `IDENT` - pattern: `[a-zA-Z0-9_.]+` (includes dots!)\n- `STRING` - \"...\"\n- `COLON` - :\n- `ARROW_LEFT` - \u003c-\n- `ARROW_RIGHT` - -\u003e\n- `ARROW_BI` - --\n- `AND` - \u0026\u0026\n- `EOL` - \\n\n- `EOF` - end of file\n\n**Key principle:** DOT is NOT a separate token. It's part of IDENT:\n- `.type` → IDENT (value: \".type\")\n- `shape` → IDENT (value: \"shape\")\n- `=` → EQUALS\n- `box` → IDENT\n\n**Examples:**\n```\n.type: problem\n→ IDENT(\".type\"), COLON, IDENT(\"problem\")\n\nbad: \"Bad\" class=UDE shape=box\n→ IDENT(\"bad\"), COLON, STRING, IDENT(\"class\"), EQUALS, IDENT(\"UDE\"), IDENT(\"shape\"), EQUALS, IDENT(\"box\")\n\nA \u003c- B: \"label\" color=red\n→ IDENT(\"A\"), ARROW_LEFT, IDENT(\"B\"), COLON, STRING, IDENT(\"color\"), EQUALS, IDENT(\"red\")\n```\n\n**Implementation:**\n- Update IDENT regex to include `.` character\n- Add EQUALS token type\n- Keep all existing token logic\n- No context-aware tokenization\n- Tokenizer produces generic tokens only\n\n**New token types:**\n```typescript\nexport type TokenType =\n  | \"IDENT\"\n  | \"STRING\"\n  | \"COLON\"\n  | \"ARROW_LEFT\"\n  | \"ARROW_RIGHT\"\n  | \"ARROW_BI\"\n  | \"AND\"\n  | \"EQUALS\"  // NEW\n  | \"LBRACE\"\n  | \"RBRACE\"\n  | \"COMMENT\"\n  | \"EOL\"\n  | \"EOF\";\n```","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T20:22:39.002204191+03:00","updated_at":"2025-12-26T21:49:14.368068203+03:00","closed_at":"2025-12-26T21:49:14.368068203+03:00","close_reason":"Closed via update","dependencies":[{"issue_id":"toc-lang-bj0","depends_on_id":"toc-lang-13i","type":"blocks","created_at":"2025-12-26T20:22:39.012735145+03:00","created_by":"daemon"}]}
{"id":"toc-lang-cc3","title":"Create research document for PIC syntax patterns","description":"Document findings from researching PIC language syntax patterns and create comparison with current TOC-Lang syntax","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T20:56:47.819489319+03:00","updated_at":"2025-12-26T21:02:37.174401482+03:00","closed_at":"2025-12-26T21:02:37.174401482+03:00","close_reason":"Duplicate of toc-lang-cql which is already completed"}
{"id":"toc-lang-cql","title":"Research PIC language syntax patterns","description":"Research PIC language syntax patterns\n\nStudy Pikchr/PIC syntax to understand simplification patterns in docs/PIC_SYNTAX.md:\n- Parameter format: key=value (single words, space-separated)\n- Shape declarations: shape=box, shape=circle\n- Minimal punctuation\n- Compare with current TOC-Lang {key: value} blocks\n\nGoal: Understand how PIC achieves simplicity to inform our syntax simplification.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T20:22:26.849202995+03:00","updated_at":"2025-12-26T21:08:20.941122874+03:00","closed_at":"2025-12-26T20:57:07.690522831+03:00","close_reason":"Closed via update"}
{"id":"toc-lang-jq8","title":"Update CodeMirror language support","description":"Update CodeMirror language support\n\nModify src/lang.ts to provide syntax highlighting and autocomplete for new syntax from docs/PROPOSED_SYNTAX.md.\n\n**Highlighting rules:**\n```typescript\n// In myLanguage() token function:\nif (stream.match(/^#.*/)) return \"lineComment\";\nif (stream.match(\":\")) return \"punctuation\";\nif (stream.match(/^(-\u003e|\u003c-|--)/)) return \"arithmeticOperator\";\nif (stream.match(/^[.][a-zA-Z]+/)) return \"keyword\";  // .type\nif (stream.match(/^[a-zA-Z_][a-zA-Z0-9_]*/)) {\n  const word = stream.current();\n  // Check if it's a property key\n  if ([\"shape\", \"border\", \"fill\", \"color\", \"class\", \"status\"].includes(word)) {\n    return \"propertyName\";\n  }\n  // Check if it's a shape value\n  if ([\"box\", \"circle\", \"ellipse\"].includes(word)) {\n    return \"atom\";\n  }\n  // Check if it's a color value\n  if ([\"black\", \"white\", \"blue\", \"yellow\", \"green\", \"red\"].includes(word)) {\n    return \"color\";\n  }\n  // Check if it's a type value\n  if ([\"problem\", \"conflict\", \"goal\"].includes(word)) {\n    return \"keyword\";\n  }\n  // Check if it's an annotation\n  if ([\"UDE\", \"CSF\", \"FOL\", \"DE\"].includes(word)) {\n    return \"variableName\";\n  }\n  return \"name\";\n}\nif (stream.match(/^[{}]/)) return \"brace\";\nif (stream.match(/^=/)) return \"operator\";\nif (stream.match(/^\"[^\"]*\"/)) return \"string\";\n```\n\n**Autocomplete (separate tasks):**\n- After `:` → suggest strings\n- After space in node/edge → suggest property keys\n- After `=` → suggest values based on property\n- After `.` → suggest `type`\n\n**New tasks created:**\n- toc-lang-1m3: Add property key completion\n- toc-lang-8ra: Add property value completion  \n- toc-lang-p4e: Add directive completion","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T20:22:48.622644902+03:00","updated_at":"2025-12-26T21:56:11.347537324+03:00","closed_at":"2025-12-26T21:56:11.347537324+03:00","close_reason":"Closed via update","dependencies":[{"issue_id":"toc-lang-jq8","depends_on_id":"toc-lang-6rz","type":"blocks","created_at":"2025-12-26T20:22:48.633661827+03:00","created_by":"daemon"}]}
{"id":"toc-lang-nir","title":"Update tests and verify","description":"Update tests and verify\n\nRun all tests (bun test) and update approved snapshots. Ensure all interpreters still work correctly with new syntax from docs/PROPOSED_SYNTAX.md.\n\n**Tasks:**\n1. Update test cases to use new syntax\n2. Update approved snapshot files\n3. Verify interpreters handle new properties (shape, border, fill)\n4. Verify backward compatibility with old syntax\n5. Test default value application\n6. Test color parsing\n7. Test shape parsing\n\n**Test coverage needed:**\n- Type declarations with `.type: problem`\n- Nodes with `key=value` params\n- Nodes with shape properties\n- Nodes with color properties\n- Mixed old and new syntax\n- Default value application\n- Edge syntax (unchanged)\n- Comments (unchanged)\n\n**Update snapshots:**\n- src/__tests__/parses ast for input *.approved.txt\n- src/__tests__/example *.approved.txt\n\n**Verify interpreters:**\n- evaporatingCloudInterpreter.test.ts\n- problemTreeInterpreter.test.ts\n- goalTreeInterpreter.test.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-26T20:23:01.035704531+03:00","updated_at":"2025-12-26T22:05:07.46845135+03:00","closed_at":"2025-12-26T22:05:07.46845135+03:00","close_reason":"Completed. All tests pass (50/50), linting passes, build succeeds. New syntax fully implemented with backward compatibility.","dependencies":[{"issue_id":"toc-lang-nir","depends_on_id":"toc-lang-nkh","type":"blocks","created_at":"2025-12-26T20:23:01.043919399+03:00","created_by":"daemon"}]}
{"id":"toc-lang-nkh","title":"Update examples to new syntax","description":"Update examples to new syntax\n\nConvert all example files in examples/ and src/__tests__/ to use new PIC-like syntax from docs/PROPOSED_SYNTAX.md with user preferences:\n\n**Conversion rules:**\n- Change `type: problem` to `.type: problem`\n- Change `{class: UDE}` to `class=UDE`\n- Remove braces, use space-separated `key=value` format\n- Keep shape properties optional (can add later)\n- Keep existing arrow syntax\n\n**Examples:**\n\n**Current Reality Tree:**\n```\n.type: problem\n\nbad: \"Bad user experience\" class=UDE\ncluttered: \"Cluttered interface\" class=UDE\nbad \u003c- cluttered\nux: \"Low investment in UX design\"\nfeatures: \"Many features added\"\ncluttered \u003c- ux \u0026\u0026 features\n```\n\n**Evaporating Cloud:**\n```\n.type: conflict\n\nA: \"Maximize business performance\"\nB: \"Subordinate all decisions to the financial goal\"\nC: \"Ensure people are in a state of optimal performance\"\nD: \"Subordinate people's needs to the financial goal\"\nB \u003c- D: \"*inject* Psychological flow triggers\"\nE: \"Attend to people's needs (\u0026 let people work)\"\n```\n\n**Goal Tree:**\n```\n.type: goal\n\nGoal: \"Make money now and in the future\"\nrevUp: \"Generate more revenue\" class=CSF\ncostsDown: \"Control costs\" class=CSF\nGoal \u003c- revUp\nGoal \u003c- costsDown\n```\n\n**Styled examples (optional):**\n```\n.type: problem\n\nbad: \"Bad experience\" class=UDE shape=box border=red fill=red\ncluttered: \"Cluttered UI\" class=UDE shape=box border=red fill=red\nbad \u003c- cluttered\n```\n\n**Files to update:**\n- examples/crt_*.txt\n- examples/ec_*.txt\n- examples/gt_*.txt\n- Update test snapshots accordingly","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-26T20:22:57.490028182+03:00","updated_at":"2025-12-26T22:02:35.370307848+03:00","closed_at":"2025-12-26T22:02:35.370307848+03:00","close_reason":"Closed via update","dependencies":[{"issue_id":"toc-lang-nkh","depends_on_id":"toc-lang-jq8","type":"blocks","created_at":"2025-12-26T20:22:57.497981231+03:00","created_by":"daemon"}]}
{"id":"toc-lang-p1c","title":"Analyze current TOC-Lang syntax structure","description":"Analyze current TOC-Lang syntax structure\n\nDocument current TOC-Lang syntax patterns in docs/CURRENT_SYNTAX.md:\n- Node: id: \"label\" {key: value, key2: value2}\n- Edges: A \u003c- B, A -\u003e B, A -- B, A \u0026\u0026 B -\u003e C\n- Type: type: problem\n- Comments: # text\n\nCreate comparison matrix:\nCurrent: {class: UDE, status: 50}\nProposed: class=UDE status=50\n\nFocus on identifying what can be simplified while preserving TOC semantics.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T20:22:31.965410415+03:00","updated_at":"2025-12-26T21:08:28.231391722+03:00","closed_at":"2025-12-26T21:05:20.567767702+03:00","close_reason":"Closed via update","dependencies":[{"issue_id":"toc-lang-p1c","depends_on_id":"toc-lang-cql","type":"blocks","created_at":"2025-12-26T20:22:31.975293812+03:00","created_by":"daemon"}]}
{"id":"toc-lang-p4e","title":"Add directive completion to CodeMirror","description":"Add autocomplete for directives in CodeMirror language support\n\nAt start of line or after EOL, suggest:\n- `.type`\n\nAfter `.type:`, suggest:\n- problem, conflict, goal","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T21:38:06.387292334+03:00","updated_at":"2025-12-26T21:57:23.549851197+03:00","closed_at":"2025-12-26T21:57:23.549851197+03:00","close_reason":"Closed via update","dependencies":[{"issue_id":"toc-lang-p4e","depends_on_id":"toc-lang-jq8","type":"blocks","created_at":"2025-12-26T21:38:43.657407881+03:00","created_by":"daemon"}]}
